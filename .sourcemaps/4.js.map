{"version":3,"sources":["../../src/pages/home/home.module.ts","../../src/pages/home/home.ts","../../src/constant/menu-home.ts"],"names":[],"mappings":"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","file":"4.js","sourcesContent":["import { NgModule } from \"@angular/core\";\nimport { IonicPageModule } from \"ionic-angular\";\nimport { HomePage } from \"./home\";\nimport { ComponentsModule } from \"../../components/components.module\";\n\n@NgModule({\n  declarations: [HomePage],\n  imports: [IonicPageModule.forChild(HomePage), ComponentsModule],\n  exports: [HomePage]\n})\nexport class HomePageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/home/home.module.ts","import { Component } from \"@angular/core\";\nimport { NavController, Platform, IonicPage } from \"ionic-angular\";\nimport { UserProvider } from \"../../providers/user/user\";\n\nimport { MenuHomeConstant } from \"../../constant/menu-home\";\nimport { HomeProvider } from \"../../providers/home/home\";\nimport { Observable } from \"rxjs/Observable\";\n\nimport \"rxjs/add/observable/zip\";\nimport { LoaderHelper } from \"../../helpers/loader-helper\";\nimport { FCM } from \"@ionic-native/fcm\";\nimport { TokenProvider } from \"../../providers/token/token\";\nimport { ToastHelper } from \"../../helpers/toast-helper\";\nimport { Storage } from \"@ionic/storage\";\n@IonicPage()\n@Component({\n  selector: \"page-home\",\n  templateUrl: \"home.html\"\n})\nexport class HomePage {\n  menus: Array<any> = [];\n  backgroundImage: string = \"assets/images/bg_login.png\";\n  notifications: Array<any> = [];\n  profile: any = {};\n\n  profileName: string = \"\";\n\n  constructor(\n    public navCtrl: NavController,\n    public userProvider: UserProvider,\n    public fcm: FCM,\n    private homeProvider: HomeProvider,\n    private loaderHelper: LoaderHelper,\n    private token: TokenProvider,\n    private toast: ToastHelper,\n    private platform: Platform,\n    private storage: Storage\n  ) {}\n\n  ionViewDidLoad() {\n    this.listMenu();\n    this.initData();\n    this.platform.ready().then(() => {\n      this.fcmGetToken();\n    });\n  }\n\n  listMenu() {\n    this.menus = MenuHomeConstant.getMenus();\n    return this.menus;\n  }\n\n  mappingResponNotif(res?: any) {\n    return this.menus.map((data, index) => {\n      data.notificationTotal = this.setNotificationTotal(data.title, res);\n    });\n  }\n  setNotificationTotal(title: any, res: any) {\n    if (title === \"PERSURATAN\") return res.notification_persuratan;\n\n    if (title === \"PERSONAL\") return res.notification_personal;\n\n    if (title === \"APT\") return res.notification_apt;\n  }\n\n  pagesTo(component: any) {\n    this.navCtrl.push(component);\n  }\n\n  logout() {\n    this.loaderHelper.createLoader();\n    this.userProvider.logout().subscribe(\n      () => {\n        this.userProvider.purgeAuth();\n        this.navCtrl.setRoot(\"LoginPage\");\n        this.loaderHelper.dismiss();\n      },\n      err => {\n        this.userProvider.purgeAuth();\n        this.loaderHelper.dismiss();\n        this.navCtrl.setRoot(\"LoginPage\");\n      }\n    );\n  }\n\n  private assets(name: string) {\n    return `assets/icon/${name}.png`;\n  }\n\n  fcmGetToken() {\n    this.fcm.getToken().then(\n      token => {\n        this.userProvider.saveFcmToken(token).subscribe();\n      },\n      err => {}\n    );\n    this.fcm.onTokenRefresh().subscribe(\n      token => {\n        this.userProvider.saveFcmToken(token).subscribe();\n      },\n      err => {}\n    );\n  }\n\n  async initData() {\n    const profile = await this.token.getProfile();\n    const getTotalNotif = await this.homeProvider.getTotalNotication();\n\n    // get profile dari localStorage jika sudah ada\n    if (profile) {\n      this.profile = profile;\n      this.profileName = profile.nip;\n      getTotalNotif.subscribe(\n        res => this.mappingResponNotif(res),\n        err => {\n          this.userProvider.purgeAuth();\n          this.navCtrl.setRoot(\"LoginPage\");\n        }\n      );\n    } else {\n      const getProfile = this.userProvider.getProfile();\n\n      Observable.zip(getProfile, getTotalNotif).subscribe(\n        ([profile, totalNotif]) => {\n          this.profile = profile;\n          this.profileName = profile.nip;\n\n          this.mappingResponNotif(totalNotif);\n        },\n        err => false\n      );\n    }\n  }\n\n  //  by pass plt/plh\n  byPass(nip: string) {\n    //cek apakah nip yg di select, sama dengan currentUser\n    if (nip == this.profile.nip) {\n      //jika ada, ubah token kembali dengan user asli/bukan plt -plh nya\n      this.storage.get(\"token\").then(res => {\n        this.token.latestToken = res;\n        this.initData();\n      }, err => true);\n    } else {\n      this.loaderHelper.createLoader();\n      this.userProvider.byPass(nip).subscribe(\n        res => {\n          this.token.saveTokenPltPlh(res);\n          this.initData();\n          this.loaderHelper.dismiss();\n        },\n        err => {\n          this.loaderHelper.dismiss();\n          this.toast.present(err.error_message);\n        }\n      );\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/home/home.ts","export class MenuHomeConstant {\n  public static getMenus(): Array<any> {\n    const menus = [\n      {\n        title: \"PERSURATAN\",\n        subtitle: \"Pemberitahuan Persuratan\",\n        iconSmall: \"mail_sm\",\n        iconLarge: \"mail_lg\",\n        component: \"SuratPage\",\n        color: \"blue-light\"\n      },\n      {\n        title: \"PERSONAL\",\n        subtitle: \"Pemberitahuan Kalender Kegiatan\",\n        iconSmall: \"calendar_sm\",\n        iconLarge: \"calendar_lg\",\n        component: \"PersonalPage\",\n        color: \"orange\"\n      },\n      {\n        title: \"APT\",\n        subtitle: \"Pemberitahuan Supervisi\",\n        iconSmall: \"checkmark-circle-outline_sm\",\n        iconLarge: \"checkmark-circle-outline_lg\",\n        component: \"TabsPage\",\n        color: \"green-light\"\n      }\n    ];\n\n    return menus;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/constant/menu-home.ts"],"sourceRoot":""}