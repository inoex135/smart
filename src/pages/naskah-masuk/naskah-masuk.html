<ion-header>
  <ion-navbar>
    <ion-title>Daftar Naskah Masuk</ion-title>
  </ion-navbar>
</ion-header>

<ion-content>
  <ion-list no-lines padding>
    <ion-header>
      <div class="row">
          <div class="col col-50">
              <ion-item class="input--form daftar-naskah-filter">
                  <ion-select (ionChange)="searchNaskahBy('type', filter?.naskahUnit)" [(ngModel)]="filter.naskahUnit" placeholder="Tujuan Naskah">
                    <ion-option value="alltype">Semua</ion-option>
                    <ion-option value="unit">Naskah Unit</ion-option>
                    <ion-option value="personal">Naskah Pribadi</ion-option>
                    <ion-option value="permohonan">Naskah Permohonan</ion-option>
                  </ion-select>
                </ion-item>
          </div>
          <div class="col col-50">
              <ion-item class="input--form daftar-naskah-filter">
                  <ion-select (ionChange)="searchNaskahBy('sifat', filter?.naskahSifat)" [(ngModel)]="filter.naskahSifat" placeholder="Sifat Naskah">
                    <ion-option value="">Semua</ion-option>
                    <ion-option value="0">Biasa</ion-option>
                    <ion-option value="11">Segera</ion-option>
                    <ion-option value="12">Sangat Segera</ion-option>
                    <ion-option value="23">Kilat</ion-option>
                  </ion-select>
                </ion-item>
          </div>
      </div>
      
      <ion-searchbar [(ngModel)]="filter.keyword" search-bar-bcg (ionInput)="searchNaskahBy('search', $event?.target?.value)" (ionCancel)="searchNaskahBy('search', $event?.target?.value)"></ion-searchbar>
    </ion-header>
    <ion-item *ngIf="searching" class="spinner-container">
      <ion-spinner></ion-spinner>
    </ion-item>
  </ion-list>


  <ion-list class="daftar-naskah-all">
    <ion-card padding (press)="pressAndHoldSurat(naskah)" *ngFor="let naskah of listNaskah" class="naskah-list">
      <ion-row>

        <ion-col (tap)="detailNaskah(naskah)">
          <h6 ion-text text-right>{{naskah?.tanggalSurat | indonesianDate: 'DD MMMM YYYY': 'x'}}</h6>
        </ion-col>
      </ion-row>
      <ion-row>
        <ion-col col-1 margin-right *ngIf="isBulkAction" class="checkbox-input">
          <ion-checkbox *ngIf="naskah?.statusTerimaSurat != 1" color="green-light" (ionChange)="selectedNaskah(naskah?.id, $event)"></ion-checkbox>
        </ion-col>
        <ion-col (tap)="detailNaskah(naskah)">
          <h6 ion-text card-title text-left text-wrap>{{naskah?.nomorSurat}}</h6>
          <p ion-text text-wrap>{{naskah?.perihal}}</p>
          <p ion-text class="unit-pemohon">{{naskah?.namaUnit || "-"}}</p>

          <p ion-text text-wrap>{{naskah?.namaPemohon}}</p>
          <p ion-text text-wrap>{{naskah?.pelayanan}}</p>
          <p ion-text text-wrap>{{naskah?.subPelayan}}</p>
          <p ion-text text-wrap>{{naskah?.normaWaktu}}</p>
        </ion-col>
      </ion-row>
    </ion-card>
  </ion-list>

  <ion-infinite-scroll (ionInfinite)="doInfinite($event)">
    <ion-infinite-scroll-content loadingSpinner="bubbles" loadingText="Loading more data..."></ion-infinite-scroll-content>
  </ion-infinite-scroll>

  <empty-state *ngIf="listNaskah?.length == 0"></empty-state>

</ion-content>

<ion-footer *ngIf="isBulkAction">
  <ion-row>
    <ion-col col-4 push-2>
      <button (tap)="showModalTerimaNaskah()" ion-button color="green-light">Terima Semua Naskah</button>
    </ion-col>
  </ion-row>
</ion-footer>
